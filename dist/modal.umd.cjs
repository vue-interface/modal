(function(i,d){typeof exports=="object"&&typeof module<"u"?d(exports,require("@vue-interface/btn"),require("vue"),require("css-unit-converter")):typeof define=="function"&&define.amd?define(["exports","@vue-interface/btn","vue","css-unit-converter"],d):(i=typeof globalThis<"u"?globalThis:i||self,d(i.Modal={},i.Btn,i.Vue,i.CSSUnitConverter))})(this,function(i,d,t,u){"use strict";const y={props:{buttons:{type:[Boolean,Array],default:void 0,validate(e){return Array.isArray(e)||!e}},cancel:{type:Function,default(e,o,n,s){s(!1)}},cancelButton:Object,confirm:{type:Function,default(e,o,n,s){s(!0)}},confirmButton:Object,resolve:{type:Function,default(e,o,n,s){s&&n.close()}},show:{type:Boolean,defaut:!1}},methods:{focus(){this.$el.focus()},close(e){return new Promise(o=>{e=e||new Event("close",{cancelable:!0});const n=()=>{this.isClosing=!0,this.isShowing=!1,this.transition(()=>{this.isClosing=!1,this.isDisplaying=!1,this.$emit("closed",e),o(this)})};this.$emit("close",e,this.$refs.close,this,n),e.defaultPrevented||n()})},buttonAttributes(e){return Object.assign({class:null,disabled:!1,size:"md",variant:"primary"},Object.fromEntries(Object.entries(e).filter(([o])=>!o.match(/^on[A-Z]/))))},open(){return new Promise(e=>{const o=new Event("close",{cancelable:!0}),n=()=>{this.isDisplaying=!0,setTimeout(()=>{this.isShowing=!0,this.transition(()=>{this.$emit("opened"),e(this)})})};this.$emit("open",o,n),o.defaultPrevented||n()})},transition(e){const n=getComputedStyle(this.$refs.dialog).transitionDuration.split(",").map(s=>{const r=s.trim().match(/^([\d.]+)(\w+)$/);if(!r)return 0;const l=parseFloat(r[1]),a=r[2];return u(l,a,"ms")}).sort((s,r)=>s-r).shift();return setTimeout(e,n)},toggle(){this.isShowing?this.close():this.open()}},computed:{triggerableClasses(){return{show:this.isShowing}},computedCancelButton(){const e={variant:"secondary",label:"Cancel",name:"confirm",onClick:o=>{this.cancel(o,e,this,(...n)=>{this.resolve(o,e,this,...n)})}};return this.cancelButton||e},computedConfirmButton(){const e={variant:"primary",label:"Confirm",name:"confirm",onClick:o=>{this.confirm(o,e,this,(...n)=>{this.resolve(o,e,this,...n)})}};return this.confirmButton||e},currentButtons(){if(Array.isArray(this.buttons))return t.ref(this.buttons).value.map(e=>{const o=e.onClick||(()=>{});return Object.assign(e,{onClick:n=>o(n,e,this,(...s)=>this.resolve(n,e,this,...s))})});if(this.type==="alert")return[this.computedConfirmButton];if(this.type==="confirm")return[this.computedConfirmButton,this.computedCancelButton]}},watch:{isShowing(e){e&&this.focus()},show(e){e&&this.open()}},mounted(){this.show&&this.open()},data(){return{isClosing:!1,isShowing:!1,isDisplaying:!1}}},b=t.defineComponent({name:"Modal",components:{Btn:d.Btn},mixins:[y],beforeRouteLeave(){this.close()},props:{backdrop:{type:Boolean,default:!0},center:Boolean,closeable:{type:Boolean,default:!0},footer:{type:Boolean,default:!0},indicator:{type:Object,default:void 0},title:{type:String,default:void 0},type:{type:[Boolean,String],default:!1,validate(e){return["alert","confirm"].indexOf(e)!==-1}}},watch:{isShowing(e){var o;(o=document.querySelector("body"))==null||o.classList[e?"add":"remove"]("modal-open")}}}),N="",g=(e,o)=>{const n=e.__vccOpts||e;for(const[s,r]of o)n[s]=r;return n},B={class:"modal-content"},k={class:"modal-header"},C={key:0,class:"modal-title"},w=["disabled"],S=[t.createElementVNode("span",{"aria-hidden":"true"},"Ã—",-1)],$={class:"modal-body"},j={key:0,ref:"footer",class:"modal-footer"},E={class:"modal-footer-buttons"};function O(e,o,n,s,r,l){const a=t.resolveComponent("btn");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["modal fade",{...e.triggerableClasses}]),style:t.normalizeStyle({display:e.isDisplaying?"block":"none"}),tabindex:"-1",onKeydown:o[2]||(o[2]=t.withKeys((...c)=>e.close&&e.close(...c),["esc"]))},[t.renderSlot(e.$slots,"backdrop",{},()=>[e.backdrop&&e.isDisplaying?(t.openBlock(),t.createElementBlock("div",{key:0,ref:"backdrop",class:t.normalizeClass(["modal-backdrop fade",{show:e.isShowing}]),onClick:o[0]||(o[0]=c=>e.closeable&&e.close)},null,2)):t.createCommentVNode("",!0)]),t.createElementVNode("div",{ref:"dialog",class:t.normalizeClass(["modal-dialog",{"modal-dialog-centered":e.center}])},[t.createElementVNode("div",B,[t.renderSlot(e.$slots,"header",{},()=>[t.createElementVNode("div",k,[t.renderSlot(e.$slots,"title",{},()=>[e.title?(t.openBlock(),t.createElementBlock("h3",C,t.toDisplayString(e.title),1)):t.createCommentVNode("",!0)]),t.renderSlot(e.$slots,"close-button",{},()=>[e.closeable?(t.openBlock(),t.createElementBlock("button",{key:0,ref:"close",type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",disabled:e.isClosing,onClick:o[1]||(o[1]=(...c)=>e.close&&e.close(...c))},S,8,w)):t.createCommentVNode("",!0)])])]),t.renderSlot(e.$slots,"body",{},()=>[(t.openBlock(),t.createBlock(t.Suspense,null,{fallback:t.withCtx(()=>[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.indicator)))]),default:t.withCtx(()=>[t.createElementVNode("div",$,[t.renderSlot(e.$slots,"default",{ref:"content"})])]),_:3}))]),e.footer?t.renderSlot(e.$slots,"footer",{key:0,close:e.close},()=>[e.currentButtons.length?(t.openBlock(),t.createElementBlock("div",j,[t.createElementVNode("div",E,[e.currentButtons.length?(t.openBlock(!0),t.createElementBlock(t.Fragment,{key:0},t.renderList(e.currentButtons,(c,f)=>(t.openBlock(),t.createBlock(a,t.mergeProps({key:`btn-${f}`},c),null,16))),128)):t.createCommentVNode("",!0)])],512)):t.createCommentVNode("",!0)]):t.createCommentVNode("",!0)])],2)],38)}const m=g(b,[["render",O]]);class h{constructor(o,n){this.app=o,this.props=n}mount(o){o.appContext=this.app._context;const n=document.createElement("div");t.render(t.h(o),n),document.body.append(n)}register(o,n){Object.defineProperty(this,o,{value:(s,r,l)=>{const a=new Promise((c,f)=>{this.mount(n({title:s,props:Object.assign({},this.props,l),resolve:p=>(c(p),a),reject:p=>(f(p),a),promise:()=>a,content:typeof r=="string"?t.h("div",r):r(this.app,l)}))});return a}})}}const V=(e,o={})=>{const n=new h(e,o);n.register("alert",({title:s,content:r,props:l})=>t.h(m,Object.assign({title:s,show:!0,type:"alert"},l),{default:()=>t.h(r,Object.assign({ref:"content"}))})),n.register("confirm",({title:s,content:r,props:l})=>t.h(m,Object.assign({title:s,show:!0,type:"confirm"},l),{default:()=>t.h(r,Object.assign({ref:"content"}))})),e.provide("modal",n),e.config.globalProperties.$modal=n};i.Modal=m,i.ModalFactory=h,i.ModalPlugin=V,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=modal.umd.cjs.map
