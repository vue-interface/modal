(function(i,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(i=typeof globalThis<"u"?globalThis:i||self,t(i.Modal={},i.Vue))})(this,function(i,t){"use strict";const g={name:"Btn",mixins:[{props:{componentPrefix:String,size:String,sizePrefix:String},computed:{sizeableClassPrefix(){return this.sizePrefix||this.componentPrefix},hasSizeablePrefix(){return this.size&&!!this.size.match(new RegExp(`^${this.sizeableClassPrefix}`))},sizeableClass(){return this.size?!this.sizeableClassPrefix||this.hasSizeablePrefix?this.size:`${this.sizeableClassPrefix}-${this.size}`:""}}},{props:{componentPrefix:String,variant:String,variantPrefix:String},computed:{variantClassPrefix(){return this.variantPrefix||this.componentPrefix},hasVariantPrefix(){return this.variant&&!!this.variant.match(new RegExp(`^${this.variantClassPrefix}`))},variantClass(){return this.variant?!this.variantClassPrefix||this.hasVariantPrefix?this.variant:`${this.variantClassPrefix}-${this.variant}`:""}}}],props:{active:Boolean,block:Boolean,componentPrefix:{type:String,default:"btn"},disabled:Boolean,label:String,outline:Boolean,tag:String,variant:{type:String,default:"primary"}},computed:{classes(){return["btn",this.variantClass,this.sizeableClass,this.active&&"active",this.block&&"btn-block",this.disabled&&"disabled"]},component(){return this.tag?this.tag:this.$attrs.href?"a":"button"},variantClassPrefix(){return(this.variantPrefix||this.componentPrefix)+(this.outline?"-outline":"")}}},f=(e,s)=>{const n=e.__vccOpts||e;for(const[o,r]of s)n[o]=r;return n};function b(e,s,n,o,r,a){return t.openBlock(),t.createBlock(t.resolveDynamicComponent(a.component),t.mergeProps(e.$attrs,{disabled:n.disabled,class:a.classes,role:"button"}),{default:t.withCtx(()=>[t.renderSlot(e.$slots,"default",{},()=>[t.createTextVNode(t.toDisplayString(n.label),1)])]),_:3},16,["disabled","class"])}const y=f(g,[["render",b]]);var d={px:{px:1,cm:96/2.54,mm:96/25.4,in:96,pt:96/72,pc:16},cm:{px:2.54/96,cm:1,mm:.1,in:2.54,pt:2.54/72,pc:2.54/6},mm:{px:25.4/96,cm:10,mm:1,in:25.4,pt:25.4/72,pc:25.4/6},in:{px:1/96,cm:1/2.54,mm:1/25.4,in:1,pt:1/72,pc:1/6},pt:{px:.75,cm:72/2.54,mm:72/25.4,in:72,pt:1,pc:12},pc:{px:6/96,cm:6/2.54,mm:6/25.4,in:6,pt:6/72,pc:1},deg:{deg:1,grad:.9,rad:180/Math.PI,turn:360},grad:{deg:400/360,grad:1,rad:200/Math.PI,turn:400},rad:{deg:Math.PI/180,grad:Math.PI/200,rad:1,turn:Math.PI*2},turn:{deg:1/360,grad:1/400,rad:.5/Math.PI,turn:1},s:{s:1,ms:1/1e3},ms:{s:1e3,ms:1},Hz:{Hz:1,kHz:1e3},kHz:{Hz:1/1e3,kHz:1},dpi:{dpi:1,dpcm:1/2.54,dppx:1/96},dpcm:{dpi:2.54,dpcm:1,dppx:2.54/96},dppx:{dpi:96,dpcm:96/2.54,dppx:1}},C=function(e,s,n,o){if(!d.hasOwnProperty(n))throw new Error("Cannot convert to "+n);if(!d[n].hasOwnProperty(s))throw new Error("Cannot convert from "+s+" to "+n);var r=d[n][s]*e;return o!==!1?(o=Math.pow(10,parseInt(o)||5),Math.round(r*o)/o):r};const B={props:{buttons:{type:[Boolean,Array],default:void 0,validate(e){return Array.isArray(e)||!e}},cancel:{type:Function,default(e,s,n,o){o(!1)}},cancelButton:Object,confirm:{type:Function,default(e,s,n,o){o(!0)}},confirmButton:Object,resolve:{type:Function,default(e,s,n,o){n.close()}},show:{type:Boolean,defaut:!1}},setup(e){console.log("setup")},methods:{focus(){this.$el.focus()},close(e){return new Promise(s=>{e=e||new Event("close",{cancelable:!0});const n=()=>{this.isClosing=!0,this.isShowing=!1,this.transition(()=>{this.isClosing=!1,this.isDisplaying=!1,this.$emit("closed",e),s(this)})};this.$emit("close",e,this.$refs.close,this,n),e.defaultPrevented||n()})},buttonAttributes(e){return Object.assign({class:null,disabled:!1,size:"md",variant:"primary"},Object.fromEntries(Object.entries(e).filter(([s,n])=>!s.match(/^on[A-Z]/))))},getCurrentButtons(){if(Array.isArray(this.buttons))return t.ref(this.buttons).value.map(e=>{const s=e.onClick;return Object.assign(e,{onClick:n=>s(n,e,this,(...o)=>this.resolve(n,e,this,...o))})});if(this.type==="alert")return[this.computedConfirmButton];if(this.type==="confirm")return[this.computedConfirmButton,this.computedCancelButton]},open(){return new Promise(e=>{const s=new Event("close",{cancelable:!0}),n=()=>{this.isDisplaying=!0,setTimeout(()=>{this.isShowing=!0,this.transition(()=>{this.$emit("opened"),e(this)})})};this.$emit("open",s,n),s.defaultPrevented||n()})},transition(e){const n=getComputedStyle(this.$refs.dialog).transitionDuration.split(",").map(o=>{const[r,a,l]=o.trim().match(/^([\d.]+)(\w+)$/);return C(parseFloat(a),l,"ms")}).sort((o,r)=>o-r).shift();return setTimeout(e,n)},toggle(){this.isShowing?this.close():this.open()}},computed:{triggerableClasses(){return{show:this.isShowing}},computedCancelButton(){return this.cancelButton||{variant:"secondary",label:"Cancel",name:"confirm",onClick:(e,s,n)=>{this.cancel(e,s,n,(...o)=>{this.resolve(e,s,n,...o)})}}},computedConfirmButton(){return this.confirmButton||{variant:"primary",label:"Confirm",name:"confirm",onClick:(e,s,n)=>{this.confirm(e,s,n,(...o)=>{this.resolve(e,s,n,...o)})}}}},watch:{isShowing(e){e&&this.focus()},show(e){e&&this.open()}},mounted(){this.show&&this.open()},data(){return{currentButtons:this.getCurrentButtons(),isClosing:!1,isShowing:!1,isDisplaying:!1}}},P=t.defineComponent({name:"Modal",components:{Btn:y},mixins:[B],props:{backdrop:{type:Boolean,default:!0},center:Boolean,closeable:{type:Boolean,default:!0},footer:{type:Boolean,default:!0},title:String,type:{type:[Boolean,String],default:!1,validate(e){return["alert","confirm"].indexOf(e)!==-1}}},watch:{isShowing(e){document.querySelector("body").classList[e?"add":"remove"]("modal-open")}},beforeRouteLeave(){this.close()}}),N="",k={class:"modal-content"},S={class:"modal-header"},$={key:0,class:"modal-title"},w=["disabled"],z=[t.createElementVNode("span",{"aria-hidden":"true"},"\xD7",-1)],_={class:"modal-body"},x={key:0,ref:"footer",class:"modal-footer"},E={class:"modal-footer-buttons"};function M(e,s,n,o,r,a){const l=t.resolveComponent("btn");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["modal fade",{...e.triggerableClasses}]),style:t.normalizeStyle({display:e.isDisplaying?"block":"none"}),tabindex:"-1",onKeydown:s[2]||(s[2]=t.withKeys((...c)=>e.close&&e.close(...c),["esc"]))},[t.renderSlot(e.$slots,"backdrop",{},()=>[e.backdrop&&e.isDisplaying?(t.openBlock(),t.createElementBlock("div",{key:0,ref:"backdrop",class:t.normalizeClass(["modal-backdrop fade",{show:e.isShowing}]),onClick:s[0]||(s[0]=c=>e.closeable&&e.close)},null,2)):t.createCommentVNode("",!0)]),t.createElementVNode("div",{ref:"dialog",class:t.normalizeClass(["modal-dialog",{"modal-dialog-centered":e.center}])},[t.createElementVNode("div",k,[t.renderSlot(e.$slots,"header",{},()=>[t.createElementVNode("div",S,[t.renderSlot(e.$slots,"title",{},()=>[e.title?(t.openBlock(),t.createElementBlock("h3",$,t.toDisplayString(e.title),1)):t.createCommentVNode("",!0)]),t.renderSlot(e.$slots,"close-button",{},()=>[e.closeable?(t.openBlock(),t.createElementBlock("button",{key:0,ref:"close",type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",disabled:e.isClosing,onClick:s[1]||(s[1]=(...c)=>e.close&&e.close(...c))},z,8,w)):t.createCommentVNode("",!0)])])]),t.renderSlot(e.$slots,"body",{},()=>[t.createElementVNode("div",_,[t.renderSlot(e.$slots,"default")])]),e.footer?t.renderSlot(e.$slots,"footer",{key:0,close:e.close},()=>[e.currentButtons.length?(t.openBlock(),t.createElementBlock("div",x,[t.createElementVNode("div",E,[e.currentButtons.length?(t.openBlock(!0),t.createElementBlock(t.Fragment,{key:0},t.renderList(e.currentButtons,(c,p)=>(t.openBlock(),t.createBlock(l,t.mergeProps({key:`btn-${p}`},c),null,16))),128)):t.createCommentVNode("",!0)])],512)):t.createCommentVNode("",!0)]):t.createCommentVNode("",!0)])],2)],38)}const m=f(P,[["render",M]]);class u{constructor(s){this.app=s}mount(s){s.appContext=this.app._context;const n=document.createElement("div");t.render(t.h(s),n),document.body.append(n)}register(s,n){Object.defineProperty(this,s,{value:(o,r,a)=>{const l=new Promise((c,p)=>{this.mount(n({props:a,title:o,resolve:h=>(c(h),l),reject:h=>(p(h),l),promise:()=>l,content:typeof r=="string"?t.h("div",r):r(this.app,a)}))});return l}})}}const O=e=>{const s=new u(e);s.register("alert",({title:n,content:o,props:r})=>t.h(m,Object.assign({title:n,show:!0,type:"alert"},r),{default:()=>t.h(o,Object.assign({ref:"content"},r))})),s.register("confirm",({title:n,content:o,props:r})=>t.h(m,Object.assign({title:n,show:!0,type:"confirm"},r),{default:()=>t.h(o,Object.assign({ref:"content"},r))})),e.provide("modal",s),e.config.globalProperties.$modal=s};i.Modal=m,i.ModalFactory=u,i.ModalPlugin=O,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
